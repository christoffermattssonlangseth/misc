
%%
% Cy3_SBL_ROI1 = readtable('I:\export\SBL_CYCLE2_ROI1_OP\SBL_CYCLE2_ROI1_OP_Cy3 (LED Filter 555)_ORG.csv');
% Cy5_SBL_ROI1 = readtable('I:\export\SBL_CYCLE2_ROI1_OP\SBL_CYCLE2_ROI1_OP_Cy5_ORG.csv');
% Cy7_SBL_ROI1 = readtable('I:\export\SBL_CYCLE2_ROI1_OP\SBL_CYCLE2_ROI1_OP_AF750Cy7_ORG.csv');
% A488_SBL_ROI1 = readtable('I:\export\SBL_CYCLE2_ROI1_OP\SBL_CYCLE2_ROI1_OP_FITC488_ORG.csv');
% 
% Cy3_SBL_ROI2 = readtable('I:\export\SBL_CYCLE2_ROI2_OP\SBL_CYCLE2_ROI2_OP_Cy3 (LED Filter 555)_ORG.csv');
% Cy5_SBL_ROI2 = readtable('I:\export\SBL_CYCLE2_ROI2_OP\SBL_CYCLE2_ROI2_OP_Cy5_ORG.csv');
% Cy7_SBL_ROI2 = readtable('I:\export\SBL_CYCLE2_ROI2_OP\SBL_CYCLE2_ROI2_OP_AF750Cy7_ORG.csv');
% A488_SBL_ROI2 = readtable('I:\export\SBL_CYCLE2_ROI2_OP\SBL_CYCLE2_ROI2_OP_FITC488_ORG_1.csv');
% 
% Cy3_SBL_ROI3 = readtable('I:\export\SBL_CYCLE2_ROI3_OP\SBL_CYCLE2_ROI3_OP_Cy3 (LED Filter 555)_ORG.csv');
% Cy5_SBL_ROI3 = readtable('I:\export\SBL_CYCLE2_ROI3_OP\SBL_CYCLE2_ROI3_OP_Cy5_ORG.csv');
% Cy7_SBL_ROI3 = readtable('I:\export\SBL_CYCLE2_ROI3_OP\SBL_CYCLE2_ROI3_OP_AF750Cy7_ORG.csv');
% A488_SBL_ROI3 = readtable('I:\export\SBL_CYCLE2_ROI3_OP\SBL_CYCLE2_ROI3_OP_FITC488_ORG.csv');

% on macOS 
% cycle 1
Cy3_SBL_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI1_OP/Orthogonal Projection 1 _c2_ORG.csv');
Cy5_SBL_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI1_OP/Orthogonal Projection 1 _c3_ORG.csv');
Cy7_SBL_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI1_OP/Orthogonal Projection 1 _c4_ORG.csv');
A488_SBL_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI1_OP/Orthogonal Projection 1 _c5_ORG.csv');

Cy3_SBL_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI2_OP/Orthogonal Projection 2_c2_ORG.csv');
Cy5_SBL_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI2_OP/Orthogonal Projection 2_c3_ORG.csv');
Cy7_SBL_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI2_OP/Orthogonal Projection 2_c4_ORG.csv');
A488_SBL_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI2_OP/Orthogonal Projection 2_c5_ORG.csv');

Cy3_SBL_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI3_OP/Orthogonal Projection 3_c2_ORG.csv');
Cy5_SBL_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI3_OP/Orthogonal Projection 3_c3_ORG.csv');
Cy7_SBL_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI3_OP/Orthogonal Projection 3_c4_ORG.csv');
A488_SBL_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE1_ROI3_OP/Orthogonal Projection 3_c5_ORG.csv');

% cycle 2 
% Cy3_SBL_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI1_OP/SBL_CYCLE2_ROI1_OP_Cy3 (LED Filter 555)_ORG.csv');
% Cy5_SBL_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI1_OP/SBL_CYCLE2_ROI1_OP_Cy5_ORG.csv');
% Cy7_SBL_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI1_OP/SBL_CYCLE2_ROI1_OP_AF750Cy7_ORG.csv');
% A488_SBL_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI1_OP/SBL_CYCLE2_ROI1_OP_FITC488_ORG.csv');
% 
% Cy3_SBL_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI2_OP/SBL_CYCLE2_ROI2_OP_Cy3 (LED Filter 555)_ORG.csv');
% Cy5_SBL_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI2_OP/SBL_CYCLE2_ROI2_OP_Cy5_ORG.csv');
% Cy7_SBL_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI2_OP/SBL_CYCLE2_ROI2_OP_AF750Cy7_ORG.csv');
% A488_SBL_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI2_OP/SBL_CYCLE2_ROI2_OP_FITC488_ORG.csv');
% 
% Cy3_SBL_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI3_OP/SBL_CYCLE2_ROI3_OP_Cy3 (LED Filter 555)_ORG.csv');
% Cy5_SBL_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI3_OP/SBL_CYCLE2_ROI3_OP_Cy5_ORG.csv');
% Cy7_SBL_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI3_OP/SBL_CYCLE2_ROI3_OP_AF750Cy7_ORG.csv');
% A488_SBL_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBL_CYCLE2_ROI3_OP/SBL_CYCLE2_ROI3_OP_FITC488_ORG.csv');

%%
% getting the max intensities 
Cy3_MaxIntensity_SBL_ROI1 = Cy3_SBL_ROI1.Var11;
Cy5_MaxIntensity_SBL_ROI1 = Cy5_SBL_ROI1.Var11;
Cy7_MaxIntensity_SBL_ROI1 = Cy7_SBL_ROI1.Var11;
A488_MaxIntensity_SBL_ROI1 = A488_SBL_ROI1.Var11;

Cy3_MaxIntensity_SBL_ROI2 = Cy3_SBL_ROI2.Var11;
Cy5_MaxIntensity_SBL_ROI2 = Cy5_SBL_ROI2.Var11;
Cy7_MaxIntensity_SBL_ROI2 = Cy7_SBL_ROI2.Var11;
A488_MaxIntensity_SBL_ROI2 = A488_SBL_ROI2.Var11;

Cy3_MaxIntensity_SBL_ROI3 = Cy3_SBL_ROI3.Var11;
Cy5_MaxIntensity_SBL_ROI3 = Cy5_SBL_ROI3.Var11;
Cy7_MaxIntensity_SBL_ROI3 = Cy7_SBL_ROI3.Var11;
A488_MaxIntensity_SBL_ROI3 = A488_SBL_ROI3.Var11;

Cy3_MaxIntensity_SBL_ROI1 = maxk(Cy3_SBL_ROI1.Var11, 100);
Cy5_MaxIntensity_SBL_ROI1 = maxk(Cy5_SBL_ROI1.Var11, 100);
Cy7_MaxIntensity_SBL_ROI1 = maxk(Cy7_SBL_ROI1.Var11, 100);
A488_MaxIntensity_SBL_ROI1 = maxk(A488_SBL_ROI1.Var11, 100);

Cy3_MaxIntensity_SBL_ROI2 = maxk(Cy3_SBL_ROI2.Var11, 100);
Cy5_MaxIntensity_SBL_ROI2 = maxk(Cy5_SBL_ROI2.Var11, 100);
Cy7_MaxIntensity_SBL_ROI2 = maxk(Cy7_SBL_ROI2.Var11, 100);
A488_MaxIntensity_SBL_ROI2 = maxk(A488_SBL_ROI2.Var11, 100);

Cy3_MaxIntensity_SBL_ROI3 = maxk(Cy3_SBL_ROI3.Var11, 100);
Cy5_MaxIntensity_SBL_ROI3 = maxk(Cy5_SBL_ROI3.Var11, 100);
Cy7_MaxIntensity_SBL_ROI3 = maxk(Cy7_SBL_ROI3.Var11, 100);
A488_MaxIntensity_SBL_ROI3 = maxk(A488_SBL_ROI3.Var11, 100);

%% peparing the intensity values
Cy3_Cell_Intensity_SBL_ROI1 = num2cell(Cy3_MaxIntensity_SBL_ROI1);
Cy5_Cell_Intensity_SBL_ROI1 = num2cell(Cy5_MaxIntensity_SBL_ROI1);
Cy7_Cell_Intensity_SBL_ROI1 = num2cell(Cy7_MaxIntensity_SBL_ROI1);
A488_Cell_Intensity_SBL_ROI1 = num2cell(A488_MaxIntensity_SBL_ROI1);

Cy3_Cell_Intensity_SBL_ROI2 = num2cell(Cy3_MaxIntensity_SBL_ROI2);
Cy5_Cell_Intensity_SBL_ROI2 = num2cell(Cy5_MaxIntensity_SBL_ROI2);
Cy7_Cell_Intensity_SBL_ROI2 = num2cell(Cy7_MaxIntensity_SBL_ROI2);
A488_Cell_Intensity_SBL_ROI2 = num2cell(A488_MaxIntensity_SBL_ROI2);

Cy3_Cell_Intensity_SBL_ROI3 = num2cell(Cy3_MaxIntensity_SBL_ROI3);
Cy5_Cell_Intensity_SBL_ROI3 = num2cell(Cy5_MaxIntensity_SBL_ROI3);
Cy7_Cell_Intensity_SBL_ROI3 = num2cell(Cy7_MaxIntensity_SBL_ROI3);
A488_Cell_Intensity_SBL_ROI3 = num2cell(A488_MaxIntensity_SBL_ROI3);

% concatenating the ROIs together
Cy3_Cell_Intensity_SBL = [Cy3_Cell_Intensity_SBL_ROI1; Cy3_Cell_Intensity_SBL_ROI2; Cy3_Cell_Intensity_SBL_ROI3];
Cy5_Cell_Intensity_SBL = [Cy5_Cell_Intensity_SBL_ROI1; Cy5_Cell_Intensity_SBL_ROI2; Cy5_Cell_Intensity_SBL_ROI3];
Cy7_Cell_Intensity_SBL = [Cy7_Cell_Intensity_SBL_ROI1; Cy7_Cell_Intensity_SBL_ROI2; Cy7_Cell_Intensity_SBL_ROI3];
A488_Cell_Intensity_SBL = [A488_Cell_Intensity_SBL_ROI1; A488_Cell_Intensity_SBL_ROI2; A488_Cell_Intensity_SBL_ROI3];

Cy3_Cell_Intensity_SBL = cell2mat(Cy3_Cell_Intensity_SBL)
Cy5_Cell_Intensity_SBL = cell2mat(Cy5_Cell_Intensity_SBL)
Cy7_Cell_Intensity_SBL = cell2mat(Cy7_Cell_Intensity_SBL)
A488_Cell_Intensity_SBL = cell2mat(A488_Cell_Intensity_SBL)

Cy3_Cell_Intensity_SBL = maxk(Cy3_Cell_Intensity_SBL, 300);
Cy5_Cell_Intensity_SBL = maxk(Cy5_Cell_Intensity_SBL, 300);
Cy7_Cell_Intensity_SBL = maxk(Cy7_Cell_Intensity_SBL, 300);
A488_Cell_Intensity_SBL = maxk(A488_Cell_Intensity_SBL, 300);

All_Cell_Intensity_SBL = [Cy3_Cell_Intensity_SBL; Cy5_Cell_Intensity_SBL; Cy7_Cell_Intensity_SBL; A488_Cell_Intensity_SBL]
All_Cell_Intensity_SBL = num2cell(All_Cell_Intensity_SBL)
All_Cell_Intensity_SBL = cell2mat(All_Cell_Intensity_SBL);

%% preparing the cell strings
% finding out the number of RCPs found
length_Cy3_SBL = length(Cy3_Cell_Intensity_SBL);
length_Cy5_SBL = length(Cy5_Cell_Intensity_SBL);
length_Cy7_SBL = length(Cy7_Cell_Intensity_SBL);
length_A488_SBL = length(A488_Cell_Intensity_SBL);

% create arrays of strings
Cy3_Cell_SBL = cell(length_Cy3_SBL,1);
Cy3_Cell_SBL = strcat(Cy3_Cell_SBL, 'SBL Cy3');

Cy5_Cell_SBL = cell(length_Cy5_SBL,1);
Cy5_Cell_SBL = strcat(Cy5_Cell_SBL, 'SBL Cy5');

Cy7_Cell_SBL = cell(length_Cy7_SBL,1);
Cy7_Cell_SBL = strcat(Cy7_Cell_SBL, 'SBL AF750Cy7');

A488_Cell_SBL = cell(length_A488_SBL,1);
A488_Cell_SBL = strcat(A488_Cell_SBL, 'SBL FITC488');

% concatenating the values from above
All_Cell_SBL = [Cy3_Cell_SBL; Cy5_Cell_SBL; Cy7_Cell_SBL; A488_Cell_SBL]


%%
grouporder_SBL = {'SBL Cy3', 'SBL Cy5', 'SBL AF750Cy7', 'SBL FITC488'}
width = 0.1;
showmean = true;
violinalpha = 0.3;

figure()
violinplot(All_Cell_Intensity_SBL, All_Cell_SBL,'GroupOrder',grouporder_SBL);
title('SBL vs SBL: Maximum Intensity of RCPs');
ylabel('Intensity');
ylim([0, 9000]);