
%% SBH TOP 300
% Cy3_SBH_ROI1 = readtable('I:\export\SBH_CYCLE2_ROI1_OP\SBH_CYCLE2_ROI1_OP _Cy3 (LED Filter 555)_ORG.csv');
% Cy5_SBH_ROI1 = readtable('I:\export\SBH_CYCLE2_ROI1_OP\SBH_CYCLE2_ROI1_OP _Cy5_ORG.csv');
% Cy7_SBH_ROI1 = readtable('I:\export\SBH_CYCLE2_ROI1_OP\SBH_CYCLE2_ROI1_OP _AF750Cy7_ORG.csv');
% A488_SBH_ROI1 = readtable('I:\export\SBH_CYCLE2_ROI1_OP\SBH_CYCLE2_ROI1_OP _FITC488_ORG.csv');
% 
% Cy3_SBH_ROI2 = readtable('I:\export\SBH_CYCLE2_ROI2_OP\SBH_CYCLE2_ROI2_OP_c2_ORG.csv');
% Cy5_SBH_ROI2 = readtable('I:\export\SBH_CYCLE2_ROI2_OP\SBH_CYCLE2_ROI2_OP_c3_ORG.csv');
% Cy7_SBH_ROI2 = readtable('I:\export\SBH_CYCLE2_ROI2_OP\SBH_CYCLE2_ROI2_OP_c4_ORG.csv');
% A488_SBH_ROI2 = readtable('I:\export\SBH_CYCLE2_ROI2_OP\SBH_CYCLE2_ROI2_OP_c5_ORG.csv');
% 
% Cy3_SBH_ROI3 = readtable('I:\export\SBH_CYCLE2_ROI3_OP\SBH_CYCLE2_ROI3_OP_c2_ORG.csv');
% Cy5_SBH_ROI3 = readtable('I:\export\SBH_CYCLE2_ROI3_OP\SBH_CYCLE2_ROI3_OP_c3_ORG.csv');
% Cy7_SBH_ROI3 = readtable('I:\export\SBH_CYCLE2_ROI3_OP\SBH_CYCLE2_ROI3_OP_c4_ORG.csv');
% A488_SBH_ROI3 = readtable('I:\export\SBH_CYCLE2_ROI3_OP\SBH_CYCLE2_ROI3_OP_c5_ORG.csv');

% macOS
% cycle 1
Cy3_SBH_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI1_OP/SBH_OP_1_c2_ORG.csv');
Cy5_SBH_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI1_OP/SBH_OP_1_c3_ORG.csv');
Cy7_SBH_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI1_OP/SBH_OP_1_c4_ORG.csv');
A488_SBH_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI1_OP/SBH_OP_1_c5_ORG.csv');

Cy3_SBH_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI2_OP/SBH_OP_2_c2_ORG.csv');
Cy5_SBH_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI2_OP/SBH_OP_2_c3_ORG.csv');
Cy7_SBH_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI2_OP/SBH_OP_2_c4_ORG.csv');
A488_SBH_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI2_OP/SBH_OP_2_c5_ORG.csv');

Cy3_SBH_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI3_OP/SBH_OP_3_c2_ORG.csv');
Cy5_SBH_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI3_OP/SBH_OP_3_c3_ORG.csv');
Cy7_SBH_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI3_OP/SBH_OP_3_c4_ORG.csv');
A488_SBH_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE1_ROI3_OP/SBH_OP_3_c5_ORG.csv');

%cycle 2
% Cy3_SBH_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI1_OP/SBH_CYCLE2_ROI1_OP _Cy3 (LED Filter 555)_ORG.csv');
% Cy5_SBH_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI1_OP/SBH_CYCLE2_ROI1_OP _Cy5_ORG.csv');
% Cy7_SBH_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI1_OP/SBH_CYCLE2_ROI1_OP _AF750Cy7_ORG.csv');
% A488_SBH_ROI1 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI1_OP/SBH_CYCLE2_ROI1_OP _FITC488_ORG.csv');
% 
% Cy3_SBH_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI2_OP/SBH_CYCLE2_ROI2_OP_c2_ORG.csv');
% Cy5_SBH_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI2_OP/SBH_CYCLE2_ROI2_OP_c3_ORG.csv');
% Cy7_SBH_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI2_OP/SBH_CYCLE2_ROI2_OP_c4_ORG.csv');
% A488_SBH_ROI2 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI2_OP/SBH_CYCLE2_ROI2_OP_c5_ORG.csv');
% 
% Cy3_SBH_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI3_OP/SBH_CYCLE2_ROI3_OP_c2_ORG.csv');
% Cy5_SBH_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI3_OP/SBH_CYCLE2_ROI3_OP_c3_ORG.csv');
% Cy7_SBH_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI3_OP/SBH_CYCLE2_ROI3_OP_c4_ORG.csv');
% A488_SBH_ROI3 = readtable('/Volumes/Christoffer/For SBH vs SBL/SBH_CYCLE2_ROI3_OP/SBH_CYCLE2_ROI3_OP_c5_ORG.csv');

%%
% getting the max intensities 
Cy3_MaxIntensity_SBH_ROI1 = Cy3_SBH_ROI1.Var11;
Cy5_MaxIntensity_SBH_ROI1 = Cy5_SBH_ROI1.Var11;
Cy7_MaxIntensity_SBH_ROI1 = Cy7_SBH_ROI1.Var11;
A488_MaxIntensity_SBH_ROI1 = A488_SBH_ROI1.Var11;

Cy3_MaxIntensity_SBH_ROI2 = Cy3_SBH_ROI2.Var11;
Cy5_MaxIntensity_SBH_ROI2 = Cy5_SBH_ROI2.Var11;
Cy7_MaxIntensity_SBH_ROI2 = Cy7_SBH_ROI2.Var11;
A488_MaxIntensity_SBH_ROI2 = A488_SBH_ROI2.Var11;

Cy3_MaxIntensity_SBH_ROI3 = Cy3_SBH_ROI3.Var11;
Cy5_MaxIntensity_SBH_ROI3 = Cy5_SBH_ROI3.Var11;
Cy7_MaxIntensity_SBH_ROI3 = Cy7_SBH_ROI3.Var11;
A488_MaxIntensity_SBH_ROI3 = A488_SBH_ROI3.Var11;

Cy3_MaxIntensity_SBH_ROI1 = maxk(Cy3_SBH_ROI1.Var11, 100);
Cy5_MaxIntensity_SBH_ROI1 = maxk(Cy5_SBH_ROI1.Var11, 100);
Cy7_MaxIntensity_SBH_ROI1 = maxk(Cy7_SBH_ROI1.Var11, 100);
A488_MaxIntensity_SBH_ROI1 = maxk(A488_SBH_ROI1.Var11, 100);

Cy3_MaxIntensity_SBH_ROI2 = maxk(Cy3_SBH_ROI2.Var11, 100);
Cy5_MaxIntensity_SBH_ROI2 = maxk(Cy5_SBH_ROI2.Var11, 100);
Cy7_MaxIntensity_SBH_ROI2 = maxk(Cy7_SBH_ROI2.Var11, 100);
A488_MaxIntensity_SBH_ROI2 = maxk(A488_SBH_ROI2.Var11, 100);

Cy3_MaxIntensity_SBH_ROI3 = maxk(Cy3_SBH_ROI3.Var11, 100);
Cy5_MaxIntensity_SBH_ROI3 = maxk(Cy5_SBH_ROI3.Var11, 100);
Cy7_MaxIntensity_SBH_ROI3 = maxk(Cy7_SBH_ROI3.Var11, 100);
A488_MaxIntensity_SBH_ROI3 = maxk(A488_SBH_ROI3.Var11, 100);


%% peparing the intensity values
Cy3_Cell_Intensity_SBH_ROI1 = num2cell(Cy3_MaxIntensity_SBH_ROI1);
Cy5_Cell_Intensity_SBH_ROI1 = num2cell(Cy5_MaxIntensity_SBH_ROI1);
Cy7_Cell_Intensity_SBH_ROI1 = num2cell(Cy7_MaxIntensity_SBH_ROI1);
A488_Cell_Intensity_SBH_ROI1 = num2cell(A488_MaxIntensity_SBH_ROI1);

Cy3_Cell_Intensity_SBH_ROI2 = num2cell(Cy3_MaxIntensity_SBH_ROI2);
Cy5_Cell_Intensity_SBH_ROI2 = num2cell(Cy5_MaxIntensity_SBH_ROI2);
Cy7_Cell_Intensity_SBH_ROI2 = num2cell(Cy7_MaxIntensity_SBH_ROI2);
A488_Cell_Intensity_SBH_ROI2 = num2cell(A488_MaxIntensity_SBH_ROI2);

Cy3_Cell_Intensity_SBH_ROI3 = num2cell(Cy3_MaxIntensity_SBH_ROI3);
Cy5_Cell_Intensity_SBH_ROI3 = num2cell(Cy5_MaxIntensity_SBH_ROI3);
Cy7_Cell_Intensity_SBH_ROI3 = num2cell(Cy7_MaxIntensity_SBH_ROI3);
A488_Cell_Intensity_SBH_ROI3 = num2cell(A488_MaxIntensity_SBH_ROI3);

% concatenating the ROIs together
Cy3_Cell_Intensity_SBH = [Cy3_Cell_Intensity_SBH_ROI1; Cy3_Cell_Intensity_SBH_ROI2; Cy3_Cell_Intensity_SBH_ROI3];
Cy5_Cell_Intensity_SBH = [Cy5_Cell_Intensity_SBH_ROI1; Cy5_Cell_Intensity_SBH_ROI2; Cy5_Cell_Intensity_SBH_ROI3];
Cy7_Cell_Intensity_SBH = [Cy7_Cell_Intensity_SBH_ROI1; Cy7_Cell_Intensity_SBH_ROI2; Cy7_Cell_Intensity_SBH_ROI3];
A488_Cell_Intensity_SBH = [A488_Cell_Intensity_SBH_ROI1; A488_Cell_Intensity_SBH_ROI2; A488_Cell_Intensity_SBH_ROI3];

Cy3_Cell_Intensity_SBH = cell2mat(Cy3_Cell_Intensity_SBH)
Cy5_Cell_Intensity_SBH = cell2mat(Cy5_Cell_Intensity_SBH)
Cy7_Cell_Intensity_SBH = cell2mat(Cy7_Cell_Intensity_SBH)
A488_Cell_Intensity_SBH = cell2mat(A488_Cell_Intensity_SBH)

Cy3_Cell_Intensity_SBH = maxk(Cy3_Cell_Intensity_SBH, 300);
Cy5_Cell_Intensity_SBH = maxk(Cy5_Cell_Intensity_SBH, 300);
Cy7_Cell_Intensity_SBH = maxk(Cy7_Cell_Intensity_SBH, 300);
A488_Cell_Intensity_SBH = maxk(A488_Cell_Intensity_SBH, 300);

All_Cell_Intensity_SBH = [Cy3_Cell_Intensity_SBH; Cy5_Cell_Intensity_SBH; Cy7_Cell_Intensity_SBH; A488_Cell_Intensity_SBH]
All_Cell_Intensity_SBH = num2cell(All_Cell_Intensity_SBH)
All_Cell_Intensity_SBH = cell2mat(All_Cell_Intensity_SBH);

%% preparing the cell strings
% finding out the number of RCPs found
length_Cy3_SBH = length(Cy3_Cell_Intensity_SBH);
length_Cy5_SBH = length(Cy5_Cell_Intensity_SBH);
length_Cy7_SBH = length(Cy7_Cell_Intensity_SBH);
length_A488_SBH = length(A488_Cell_Intensity_SBH);

% create arrays of strings
Cy3_Cell_SBH = cell(length_Cy3_SBH,1);
Cy3_Cell_SBH = strcat(Cy3_Cell_SBH, 'SBH Cy3');

Cy5_Cell_SBH = cell(length_Cy5_SBH,1);
Cy5_Cell_SBH = strcat(Cy5_Cell_SBH, 'SBH Cy5');

Cy7_Cell_SBH = cell(length_Cy7_SBH,1);
Cy7_Cell_SBH = strcat(Cy7_Cell_SBH, 'SBH AF750Cy7');

A488_Cell_SBH = cell(length_A488_SBH,1);
A488_Cell_SBH = strcat(A488_Cell_SBH, 'SBH FITC488');

% concatenating the values from above
All_Cell_SBH = [Cy3_Cell_SBH; Cy5_Cell_SBH; Cy7_Cell_SBH; A488_Cell_SBH]


%%
grouporder_SBH = {'SBH Cy3', 'SBH Cy5', 'SBH AF750Cy7', 'SBH FITC488'}
width = 0.1;
showmean = true;
violinalpha = 0.3;

figure()
violinplot(All_Cell_Intensity_SBH, All_Cell_SBH,'GroupOrder',grouporder_SBH);
title('SBL vs SBL: Maximum Intensity of RCPs');
ylabel('Intensity');
ylim([0, 9000]);